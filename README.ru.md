[вернуться в основной Readme файл](https://github.com/gaifut/GMP-Warranty_ID_bot/blob/main/README.md).

## Оглавление:
- [Для чего нужен этот бот.](#Для-чего-нужен-этот-бот)
- [Информация по использованию работающей версии бота.](#Информация-по-использованию-работающей-версии-бота)
- [Описание проекта.](#Описание-проекта)
- [Как скачать и запустить.](#Как-скачать-и-запустить)

## Для чего нужен этот бот.
Данный бот был сделан для быстрого отслеживания поставок заказчиками компании Гофромашины Премиум. В компании активно использовались уникальные ID, по которым отдел поставок в том числе отслеживал статус заказа. Для сокращения времени ответа, а также для возможности отследить заказ 24/7 была добавлена возможность делать это автоматически при помощи бота. Бот заходит в таблицу, берет статус заказа, который соответствует ID и возвращает его в ответе. Информация о запросе фиксируется в Google Sheets, что позволяет отслеживать сколько было запросов, по каким заказам итп.

При схожих запросах бота легко адаптировать, при необходимости можно расширять его функционал.

## Информация по использованию работающей версии бота.
В данный момент бот запущен и любой может протестировать его в телеграме: @Gmach_helpdesk_bot. Также можно зайти [по QR-коду с сайта ООО Гофромашины Премиум ](http://g-mach.ru/servisy-dlya-klientov).
При заходе в бота есть меню, в котором 2 кнопки:
- /start (отвечает за запуск бота)
- /help (содержит краткое описание возможностей бота)

Любой может протестировать бота, следуя пошаговым инструкциям и нажимая на inline клавиатуру.
Для реализации запросов бот будет запрашивать ID поставок ЗЧ (запасных частей) либо ID рекламаций. Ниже несколько примеров ID, которые вернут разные статусы.
### Рабочие примеры ID рекламаций:
 - Em0042205002S2104
   Данный id не является ID рекламации, поэтому бот вернет сообщение об ошибке.
 - Qu079220223W0C
   Бот вернет статус: Ожидается ответ производителя по рекламации
 - Em003280922W1C
   Бот вернет статус: Груз доставлен заказчику 01.02.2023
Чтобы проверить несколько рекламаций можно после получения статуса о рекламации вводить следующий интересующий ID.
### Рабочие примеры ID поставок:
 - Em0042205002S2104
   Бот вернет статус: Груз предеан заказчику.
 - Em003280922W1C
   Данный id не является ID поставки, поэтому бот вернет сообщение об ошибке.
 - RO0772202302S2102
   Бот вернет статус: Груз на складе поставщика. Ожидание оплаты.
   
Для того, чтобы с ID рекламаций перейти в ID поставок необходимо перезапустить бота командой /start

## Описание проекта.
### Стек:
Python, Pandas, Gspread.
### Процесс работы программы.
При получении вводных данных от пользователя (id поставки или рекламации) бот делает следующее:
1. Заходит в соответствующую Excel таблицу на прописанную вкладку (зависит от того, что запросили) и находит в столбце статус значение, которое соответствует запрошенному id. Выглядит это примерно так:
   ![Screenshot from 2024-04-11 15-09-46](https://github.com/gaifut/GMP-Warranty_ID_bot/assets/113767276/636d4a85-a217-46cc-90a3-608edfc2deb9)
Это происходит "под капотом" при помощи библиотеки pandas.
2. Если бот нашел id, то он выводит его статус пользователю, если бот не нашел id, он выводит соответствующее сообщение.
3. Бот подключается к указанному Google Sheets при помощи API гугла (библиотека gspread) и фиксирует там:
   - id user'а, сделавшего запрос
   - ID поставки или рекламации, которое юзер ввел при запросе
   - время запроса (компьютерное, Гринвич, Москва)
   - номер запроса (считается для каждого пользователя в течение 1 сесссии).
   Выглядит это так:
   ![image](https://github.com/gaifut/GMP-Warranty_ID_bot/assets/113767276/f4000d2b-4894-4da6-9fb1-2050f47fc799)
### Примечания:
- Максимальное количество запросов за 1 сессию = 25, при превышении лимита бот попросит перезапустить его.

## Как скачать и запустить.
1. Fork'ните этот репозиторий.
2. Клонируйте форкнутый репозиторий.
3. Установите зависимости из requirements.txt Команда:
   ```pip install -r requirements. txt```
4. Создайте .env файл в папке, где находится проект, в него добавьте следующие переменные (ниже указан пример с вымышленными данными):
   ```
   API_KEY=123123123:SFDSsdsfgfOYSADBasdas123asdasdAGw
   bot_username=dummy_name_bot
   bot_name=dummy_name_bot
   Google_sheets_API_details=test-name-placeholder.json
   FEEDS=https://spreadsheets.google.com/feeds
   DRIVE=https://www.googleapis.com/auth/drive
   ```
   Если вы не хотите использовать какую-то функциональность, например Google API, то можно просто убрать код, отвечающий за это.
5. Создайте файл sensitive.py, в котором укажите адреса файлов с таблицами. Вы также можете не создавать отдельный файл, проект я делал давно и на Windows, поэтому оставил именно эту логику.
   Если хотите вносить минимум изменений, мой файл выглядел так:
   ```
   # sensitive.py
   # location paths
   excel_file_location_W = `указывается адрес таблицы для рекламаций`
   excel_file_location_S = `указывается адрес таблицы для обычных поставок`
   ```
